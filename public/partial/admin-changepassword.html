<script>
checktoken("uncompleted-wrapper");
</script>
<div class="wrapper" style="padding-top: 30px; padding-bottom: 330px;">
<div class="cot">        
    <p style='font-family: Copperplate, "Copperplate Gothic Light",
     fantasy; font-size: 200%; color: #073956'>Change password</p>
    <div id="signup-form">
        <div id="message-box" class="error-box">
            <p></p>
        </div>
        <div id="success-box" class="success-box">
            <p></p>
        </div>
        <form method="post" name="form">
            <input class="form-control" id="old" 
             placeholder="Old password" type="password" parsley-required="true" ng-model="old"/>
            <input class="form-control" id="new"  
             placeholder="New password" type="password" parsley-required="true" ng-model="new" />
            <input id="signin-button" onclick="change()" value="Make change" type="button" />
        </form>
    </div>
    <script>
    function change(){
        var oldPassword = form.old.value;
        var newPassword = form.new.value;
        checktoken();
        $.ajax({
            type : "PUT",
            url : "https://pocketask-api.herokuapp.com/users/password",
            data : {password:oldPassword, newpassword:newPassword},
            headers : {
                token : localStorage.getItem("token")
            },
            dataType: 'json',
            statusCode: {
                400: function(res) {
                    document.getElementById("message-box").style.display = 'block';
                    document.getElementById("message-box").innerHTML = 'Something went wrong, please try again.';
                    setTimeout(function() {
                        document.getElementById("message-box").style.display = 'none';
                    }, 5000);
                },
                200: function(res) {
                    document.getElementById("success-box").style.display = 'block';
                    document.getElementById("success-box").innerHTML = res.msg;
                    setTimeout(function() {
                        document.getElementById("success-box").style.display = 'none';
                    }, 5000);
                    document.getElementById("old").value = "";
                    document.getElementById("new").value = "";
                },
                404: function(res) {
                    document.getElementById("message-box").style.display = 'block';
                    document.getElementById("message-box").innerHTML = res.responseJSON.msg;
                    setTimeout(function() {
                        document.getElementById("message-box").style.display = 'none';
                    }, 5000);
                },
                403: function(res) {
                    document.getElementById("message-box").style.display = 'block';
                    document.getElementById("message-box").innerHTML = res.responseJSON.msg;
                    // alert(JSON.stringify(res));
                    setTimeout(function() {
                        document.getElementById("message-box").style.display = 'none';
                    }, 5000);
                },
                401: function(res) {
                    document.getElementById("message-box").style.display = 'block';
                    document.getElementById("message-box").innerHTML = res.responseJSON.msg;
                    setTimeout(function() {
                        document.getElementById("message-box").style.display = 'none';
                    }, 5000);
                }
            }
        });
    }
    
    </script>
</div>
</div>