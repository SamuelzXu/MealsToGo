<div class="rest-wrapper" style="width: 100%">
    <div class="visible-sm visible-xs" style="height: 60px;"></div>
    <div class="col-md-3">
        <div class="card">
            <p class="card-heading">Recent Number of Deliveries</p>
            <p id="current" class="card-lg-text-normal"></p>
        </div>
        <div class="card visible-lg visible-md">
            <h3 class="card-heading">Announcement</h3>
            <p class="announcement">Welcome to Pocketask Inc.</p>
        </div>
    </br></br></div>
    <div class="button-area col-md-6">
        <!-- <form method="GET" id="requestform" data-parsley-validate style="text-align: left;">
            <label>Destination</label>
            <input id="autocomplete" placeholder="Enter your address" onFocus="geolocate()" type="text" class="form-control" style="width: 100%; max-width: none;"></input>
        </form> -->
         <script>

        // var placeSearch, autocomplete;
        // var componentForm = {
        //   street_number: 'short_name',
        //   route: 'long_name',
        //   locality: 'long_name',
        //   administrative_area_level_1: 'short_name',
        //   country: 'long_name',
        //   postal_code: 'short_name'
        // };

        // function initialize() {
        //   // Create the autocomplete object, restricting the search
        //   // to geographical location types.
        //   autocomplete = new google.maps.places.Autocomplete(
        //       /** @type {HTMLInputElement} */(document.getElementById('autocomplete')),
        //       { types: ['geocode'] });
        //   // When the user selects an address from the dropdown,
        //   // populate the address fields in the form.
        //   google.maps.event.addListener(autocomplete, 'place_changed', function() {
        //     fillInAddress();
        //   });
        // }

        // // [START region_fillform]
        // function fillInAddress() {
        //   // Get the place details from the autocomplete object.
        //   var place = autocomplete.getPlace();

        //   for (var component in componentForm) {
        //     document.getElementById(component).value = '';
        //     document.getElementById(component).disabled = false;
        //   }

        //   // Get each component of the address from the place details
        //   // and fill the corresponding field on the form.
        //   for (var i = 0; i < place.address_components.length; i++) {
        //     var addressType = place.address_components[i].types[0];
        //     if (componentForm[addressType]) {
        //       var val = place.address_components[i][componentForm[addressType]];
        //       document.getElementById(addressType).value = val;
        //     }
        //   }
        // }
        // // [END region_fillform]

        // // [START region_geolocation]
        // // Bias the autocomplete object to the user's geographical location,
        // // as supplied by the browser's 'navigator.geolocation' object.
        // function geolocate() {
        //   if (navigator.geolocation) {
        //     navigator.geolocation.getCurrentPosition(function(position) {
        //       var geolocation = new google.maps.LatLng(
        //           position.coords.latitude, position.coords.longitude);
        //       autocomplete.setBounds(new google.maps.LatLngBounds(geolocation,
        //           geolocation));
        //     });
        //   }
        // }

        // initialize();
        // // [END region_geolocation]

        // </script>
        <button class="button1" id="driver-button" data-toggle="modal"
            data-target="#confirm-modal" style="height: 532px; width: 100%;">
            <p style="font-size: 400%; color: white; margin-bottom: 0px; font-weight: 700;">Request For Driver</p>
        </button>
    </div>
    <div class="col-md-3">
        <div class="card" ng-controller="histctrl" id="ctrl">
            <p class="card-heading-simple">Last Three Orders</p>
            <table class="table table-striped">
                <thead>
                    <tr>
                        <td style="font-family: Impact; color: #777;">Date & Time</td>
                        <td style="font-family: Impact; color: #777;">status</td>
                    </tr>
                </thead>
                <tbody id="history-table-body">
                    <tr ng-repeat="hist in hists">
                        <td>{{hist.date}}</td>
                        <td>{{hist.status}}</td>
                    </tr>
                </tbody>
            </table>
        </div>
		<div class="card hidden-xs">
            <p class="card-heading">Distance Check</p>
			<form method="GET" id="form" data-parsley-validate style="text-align: left;">
                <label style="margin-left: 15px;">Step 1: Enter postal code or address</label>
                <label style="margin-left: 15px;">Step 2: Press enter</label>
                <input class="form-control" style="max-width: 250px;" name="address2_st"
                    id="address2_st" placeholder="Postal Code or Address with City"
                    data-parsley-pattern="/^[A-Za-z0-9,\-\s]+$/" data-parsley-required />
    		</form>
            <p id="result"></p>
        </div>
    </div>
</div>

<script>
function histctrl($scope) {
    var hists = getHistory(3);
    $scope.hists = [];
    angular.forEach(hists, function(value) {
        value.date = new Date(value.requestedAt).toString().substring(0, 25);
        if (value.status === 9) {
            value.status = 'Driver Sent';
        } else {
            value.status = 'In Queue';
        }
        $scope.hists.push(value);
    });
}

function updateHistoryTable() {
    var hists = getHistory(3);
    var scope = angular.element($("#ctrl")).scope();
    scope.$apply(function() {
        scope.hists = [];
        angular.forEach(hists, function(value) {
            value.date = new Date(value.requestedAt).toString().substring(0, 25);
            if (value.status === 9) {
                value.status = 'Driver Sent';
            } else {
                value.status = 'In Queue';
            }
            scope.hists.push(value);
        });
    });
}
</script>
<script>
var restaurant = getRestaurant();
document.getElementById('current').innerHTML = restaurant.currentRequests;
$(document).ready(function() {
    $('#form').parsley().subscribe('parsley:form:validate', function(formInstance) {
        if (formInstance.isValid()) {
            checkDistance();
        }
    });
});
</script>
